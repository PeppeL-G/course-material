---
sidebar: auto
---
# Exam 2022-03-26
Here you find sample answers and marking guidelines to the questions on the exam 2022-03-26.

---

Start by reading through all questions.

Max score is 30 points.

* For grade 3, 40% of max score (12 points) is required
* For grade 4, 60% of max score (18 points) is required
* For grade 5, 80% of max score (24 points) is required

You are not allowed to use anything but:

* The computer you sit at to only answer the questions on this exam
* A dictionary to translate to/from English from/to your native language
* Pen and paper to sketch with (should not be submitted)

Write your answers in either English or Swedish. If you write your answers in Swedish, make sure to not introduce any translation confusement. **Write proper sentences (spelling, upper/lower case characters, punctuation, etc.).** Each answer that contains multiple obvious errors, such as:

* A sentence starting with a lower case character
* A sentence not ending with a period, question mark, or any other suitable character
* A sentence that is incomplete
* A sentence that is incomprehensible

Will automatically lose 0.25 points. The ability to express yourself in text clearly is very important for an engineer, and therefor part of the examination.

Answers that are more or less copies of sample answers given to you or copies of text found somewhere else will be rewarded 0 points. Use your own words to answer the questions.

Good luck!

## Client-side

### Question 1 (1p)
<ExamQuestion>
<template v-slot:question>

The code below will result in a runtime error when it's executed. Which is the runtime error, and what changes do you need to do to fix the error?

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clock</title>
    <script>
        
        function startClock(){
            
            const clockSpan = document.getElementById('clock')
            
            function updateClock(){
                
                const now = new Date()
                
                clockSpan.innerText = now.toString()
                
            }
            
            // Call updateClock each second in the future.
            setInterval(updateClock, 1000)
            
            // setInterval doesn't call updateClock immediately,
            // so we call it immediately ourselves. 
            updateClock()
            
        }
        
        startClock()
        
    </script>
</head>
<body>
    <span id="clock"></span>
</body>
</html>
```

</template>
<template v-slot:sample-answer>

The runtime error you get is that `clockSpan` will be `null`, and you can't access the property `innerText` of it. You get that because `document.getElementById('clock')` will be executed before the web browser has read all HTML code, so it won't find the element we're looking for, and instead return back `null`.

To fix the problem, you need to make sure `startClock()` is called after the web browser has read all HTML code. To make that happen, replace the following line of code:

```js
startClock()
```

With:

```js
document.addEventListener('DOMContentLoaded', startClock)
```

</template>
<template v-slot:marking-guidelines>

* 0.5 points for identifying the runtime error 
    * Saying that it's an error that `startClock()` is called before the web browser has read all HTML code is correct, but that is not the *runtime error* that occurs
    * Although the runtime error occurs when trying to read from `clockSpan`, I have rewarded answers that indicate that `document.getElementById('clock')` is the problem with 0.25 points (the runtime error would occur here if `document.getElementById()` would throw an exception instead of returning `null`)
* 0.5 points for functional solution

</template>
</ExamQuestion>




### Question 2 (1p)
<ExamQuestion>
<template v-slot:question>

On a webpage with three different `<form>` elements, Bob needs to add one and the same submit listener to all of them. To do that, he creates the helper function `addSubmitListenerToForm(formId)`, which is implemented like this:

```js
function onSubmit(event){
    // Some code that handles the form submission
    // (which code is not important for the question).
}

function addSubmitListenerToForm(formId){
    
    const form = document.getElementById(formId)
    
    form.addEventListener('submit', onSubmit())
    
}
```

Then, somewhere in the rest of his code, he calls `addSubmitListenerToForm()` three times, and pass it the id of respective `<form>` each time.

The code above contains an obvious error. Which is that error, and what changes do you need to do to fix it?

</template>
<template v-slot:sample-answer>

The error is on this line of code:

```js
form.addEventListener('submit', onSubmit())
```

Here, the `onSubmit()` function is currently called, and its return value is passed passed to `addEventListener()`. That's not how it should work, because the `onSubmit()` function itself should be passed to `addEventListener()`. So, the correct code is:

```js
form.addEventListener('submit', onSubmit)
```

</template>
<template v-slot:marking-guidelines>

* 0.5 points for explaining the error
* 0.5 points for suggesting a correct fix

</template>
</ExamQuestion>




### Question 3 (1p)
<ExamQuestion>
<template v-slot:question>

In a Single-Page Application (SPA), the following HTML code is created and inserted into the DOM using client-side JavaScript (`document.createElement()`, etc.) and shown to the user when the user navigates to the login page in the SPA:

```html
<h1>Login</h1>
<form id="login">
    <div>
        Username: <input type="text" id="username">
    </div>
    <div>
        Password: <input type="password" id="password">
    </div>
    <input type="submit" value="Login">
</form>
```

Immediately after that, the following client-side JavaScript function is called to handle the form with client-side JavaScript:

```js
function setupLoginPage(){
    
    const username = document.getElementById('username').value
    const password = document.getElementById('password').value
    
    const loginForm = document.getElementById('login')
    
    loginForm.addEventListener('submit', function(event){
        
        // Let's assume the sendLoginRequest() function exists,
        // and that it properly handle the login request
        // (displays errors if something goes wrong, shows
        // another page if the login succeeds, etc.).
        sendLoginRequest(username, password)
        
    })
    
}
```

The code above does not work as it should because it contains two different type of errors. Which are the two type of errors, and what changes do you need to do to the code to fix the errors?

</template>
<template v-slot:sample-answer>

**First type of error** \
The text in the `<input>` elements are read immediately when `setupLoginPage()` is called. At this point in time, they will always be empty, so when the `<form>` is submitted, the user will always try to login with an empty username and an empty password, even if the user has entered something in the `<input>` elements.

To fix this type of error, move the following two lines of code:

```js
const username = document.getElementById('username').value
const password = document.getElementById('password').value
```

To inside the submit listener, so they are executed when the `<form>` is submitted.

(optimally, `document.getElementById('username|password')` can be in `setupLoginPage()`, but reading their `value` property should happen in the event listener)

**Second type of error** \
Currently, when the `<form>` is submitted, the web browser will send its own standard HTTP request to the server, and then load the new page it gets back. Since this is an SPA, we don't want that to happen, but we should handle the form ourselves.

To prevent the web browser from sending its own standard HTTP request when the `<form>` is submitted, we should call `event.preventDefault()` in the submit listener.

</template>
<template v-slot:marking-guidelines>

* 0.25 points for text in `<input>` read too early
* 0.25 points for moving the read of `<input>` to the event listener
* 0.25 points for web browser loading new page when submitting the `<form>`
* 0.25 points for calling `event.preventDefault()`

</template>
</ExamQuestion>




### Question 4 (1p)
<ExamQuestion>
<template v-slot:question>

Alice has a webpage with HTML code that contains a frequently asked questions list, part of the code shown below (`<dl>` = *definition list*, `<dt>` = *definition term*, `<dd>` = *definition description*).

```html
<h1>Frequently Asked Questions</h1>
<dl id="faq">
    
    <dt>What's your name?<dt>
    <dd>Alice</dd>
    
    <dt>How old are you?<dt>
    <dd>20</dd>
    
    <dt>Where do you live?<dt>
    <dd>Home</dd>
    
</dl>
```

Alice don't want the answers to the questions to be shown until the user clicks on the corresponding question. To make that work, she first adds the following two CSS rules:

```css
/* Hide all answers by default. */
#faq dd{
    display none;
}

/* Show answers with the class "show". */
#faq dd.show{
    display: initial;
}
```

And then creates the following client-side JavaScript function (which will be called later):

```js
function initializeFaqList(){
    
    const dtElements = document.querySelectorAll('#faq dt')
    
    for(const dt of dtElements){
        dt.addEventListener('click', function(event){
            dt.nextElementSibling.classList.toggle('show')
        })
    }
    
}
```

Has she implemented the functionality in a bad or good way? Justify your answer.

</template>
<template v-slot:sample-answer>

She has implemented the functionality in a bad way, because users with client-side JavaScript disabled in their web browsers won't see any answers, not even when they click on the questions. Client-side JavaScript should only be used to improve the user experience for users that have client-side JavaScript enabled, not to break functionality for users that have client-side JavaScript disabled.

</template>
<template v-slot:marking-guidelines>

* 1 point for correct answer and valid justification
* -0.25 points for each weird claim

</template>
</ExamQuestion>





### Question 5 (1p)
<ExamQuestion>
<template v-slot:question>

When writing client-side JavaScript, do we need to worry about security vulnerabilities? Justify your answer.

</template>
<template v-slot:sample-answer>

Yes. For example, if the client-side JavaScript fetches a data string from the server that has been entered by another user (for example a username), and we want to display it to the user, we can't use this code:

```js
const fetchedUsername = "Alice" // We have fetched this from the server somehow.

document.getElementById('aSpan').innerHTML = fetchedUsername
```

Because then we have introduced a XSS vulnerability when we used `innerHTML` (the fetched username can contain `<script>SOME JS CODE</script>` a hacker entered when creating an account with that username, which the web browser would interpret as code and execute on other users' computers, and that code can tell the user's web browser to send bad HTTP requests to other websites).

</template>
<template v-slot:marking-guidelines>

* 1 point for correct answer and valid justification
    * Just saying something like *Yes, bad client-side JavaScript can be dangerous* or *Yes, security is something you should always worry about* is not enough (justify with an example showing where you have to think about it, or similar)
* 0.25 points for giving a vague description of how a user can hack herself with bad client-side JavaScript, OR:
* 0.5 points for an example that clearly explains (with details) how using `innerHTML` can be a security vulnerability, but fails to explain how it can be used by a hacker to inject bad client-side JS in **another** user's web browser

</template>
</ExamQuestion>




## Containers




### Question 6 (1p)
<ExamQuestion>
<template v-slot:question>

In Docker, explain the difference between the commands `RUN` and `CMD`.

</template>
<template v-slot:sample-answer>

The `RUN` command is used to specify a command that will be executed when building a new Docker image.

The `CMD` command is used to specify the command that should be executed to start the application in the Docker image, and it will be executed when the image starts running in a container.

</template>
<template v-slot:marking-guidelines>

* 0.25 points for each correct description
* 0.25 points for each description belonging to the right command
* -0.1 points for saying something specific which is not necessarily true, like mentioning "web application" (Docker is not only for web applications)

::: warning Note!
Som students answer that the `RUN` command is used to start running an image in a new container. That's what the `docker run` command is used for. 
:::

</template>
</ExamQuestion>



## Scaling



### Question 7 (2p)
<ExamQuestion>
<template v-slot:question>

In horizontal scaling, describe one benefit and one drawback with using sticky sessions compared to storing sessions in an external Redis database. 

</template>
<template v-slot:sample-answer>

When using sticky sessions, the first time (of a session) a client sends an HTTP request to the server, the server (i.e. the load balancer) will remember which application server that handled the request, and all future request from that client (within the same session) will be forwarded to that same application server.

A benefit here, compared to storing the sessions in an external Redis database, is that the web application can store the sessions locally (on the application server itself), and therefor it will be much faster at carrying out the HTTP requests (it's faster to retrieve and store the sessions).

A drawback with sticky sessions, compared to storing the sessions in an external Redis database, is that it's a bit harder to scale down. As long as an application server has an active user session, we can't take down that application server, because that particular user is dependent on her requests is being forwarded to this specific application server, because that's where her session is stored. When storing the sessions in an external Redis database, all application servers are stateless, and it doesn't matter which application server that receives which client requests, making it easier to take down application servers when the load gets lower.

</template>
<template v-slot:marking-guidelines>

* 1 point for a benefit with using sticky sessions (faster to obtain and store sessions)
* 1 point for a drawback with using sticky sessions (harder to scale down, or harder to distribute load evenly (one application server can suddenly become very slow))
* 0.25 or 0.5 points for describing a small benefit/drawback, or mentioning something relevant to the big benefit/drawback, but not going all the way

::: warning Note!
Some students write a problem with sticky sessions is that a client's requests might be sent to different servers. That's not the case; *sticky sessions* means that all requests from one and the same client are forwarded to one and the same application server, so each application server can store the sessions locally.
:::

</template>
</ExamQuestion>



## Server-side



### Question 8 (2p)
<ExamQuestion>
<template v-slot:question>

Explain what MVC is, which parts it consists of and what each part is used for. Then also explain how web applications use MVC.

Don't write any code.

</template>
<template v-slot:sample-answer>

MVC (Model View Controller) is a design pattern describing a way to design/structure the code for the graphical user interface (GUI) part of an application.

The MVC design pattern consists of three different parts: models, views and controllers.

* A Model contains the data that should be visualized in the GUI
* A View contains the code that visualizes the data in a Model
* A Controller picks which Model and View that should be used, and also listen for user interaction in the View and do what the user wants when the interactions happens, such as changing the data in the Model or using another View

When a web application makes use of MVC, the Controllers listen for incoming HTTP requests, and when they receive one, they create a Model with the data that should be sent back, and then passes that Model to a View, which embeds the data in HTML code, and then the Controller sends back the HTML code from the View in an HTTP response.

</template>
<template v-slot:marking-guidelines>

* 0.5 points for what MVC is:
    * 0.25 points for design pattern
    * 0.25 points for implementing GUI
* 0.33 points for each part name and description of each part
* 0.5 points for how web applications use of MVC
    * 0.25 points for controllers receive requests and send back responses
    * 0.25 points for Views produce HTML

::: warning Note!
Answering *Explain what MVC is* by just writing the acronym *Model View Controller* is not enough.

This question has nothing to do with a three-layered architecture, so no need (rather confusing) to involve that in your answer in this question.
:::

</template>
</ExamQuestion>




### Question 9 (3p)
<ExamQuestion>
<template v-slot:question>

Explain what a three-layered architecture is, which parts it consists of and what each part is used for. Then also explain how web applications use a three-layered architecture.

Don't write any code.

</template>
<template v-slot:sample-answer>

A three-layered architecture is a way organize the code of an application in three different layers, each with their own responsibilities:

* The *Data Access Layer* contains the code for storing and retrieving the application's data. It usually provides CRUD (Create, Read, Update and Delete) operations for this
* The *Business Logic Layer* contains the code for carrying out the tasks the user wants to do (the application's functionality), such as computing how much the user should pay for the products put in a shopping bag, verify payments, etc. It typically contains authorization (for example, only allowing the user to use the application if the user has a paid membership or if the test period is not over yet) and validation (for example, checking if data the user sends to the application is in correct format). Is uses the Data Access Layer to get access to the data
* The *Presentation Layer* is responsible for implementing an interface through which the application can be used, for example a graphical user interface that humans can use. When the user interacts with the application through the interface (for example clicks on a button), the Presentation Layer asks the Business Logic Layer to execute the task the button is associated with

In web applications, the Presentation Layer is responsible for receiving HTTP requests, and then ask the Business Logic Layer to carry out the requests. The Data Access Layer often store the data in a database. The Presentation Layer is also responsible for generating the HTTP response to send back, containing the HTML and CSS code the web browser use to display the webpage in the response.

</template>
<template v-slot:marking-guidelines>

* 0.5 points for what it is
* 0.25 points for what each part's name is
* 0.25 points for what each part is used for
* 0.5 points for how web app use it (HTTP, HTML, CSS in Presentation Layer, and description of the other layers)
* 0.5 points for good quality answers (many details, not using different names to describe the same thing, use the correct name on things, write proper and easy to read sentences, clearly explain which layer making use of which other layer, use singular and plural correctly, etc.)

::: warning Note!
Answering *Explain what a three-layered architecture is* with something like *It's an architecture*, or *It's an architecture consisting of three layers* is of course not a good way to do it. Anyone gets that understanding by just reading the name. You have to explain what it's an architecture of, and what that means (what is a layer? what does a layer consist of? Etc.).

The Presentation Layer doesn't have to make use of HTML and HTTP. This architecture can not only be used in web applications, but other type of applications too.

The Data Access Layer does not have to store data in a database. It's not called *Database Access Layer*.

Some students write the layers are independent of each other/know nothing about each others. That is not true. If it would be true, then would, for example, the Presentation Layer have no way of using the Business Logic Layer.

Many students write that the Presentation Layer receives HTTP requests, and then sends the requests to the Business Logic Layer. It really sounds like you're saying *the Business Logic Layer obtains the HTTP request*, and that is wrong; the Business Logic Layer shouldn't know the Presentation Layer makes use of HTTP at all, and therefor it can't receive HTTP requests from it. Saying that the Business Logic Layers *carries out* the request, or similar, is OK, because that does not imply the Business Logic Layers receives the HTTP request.
:::

</template>
</ExamQuestion>




### Question 10 (1p)
<ExamQuestion>
<template v-slot:question>

In a three-layered architecture, do we need to worry about SQL injections in the PL? Justify your answer.

</template>
<template v-slot:sample-answer>

No, the Presentation Layer is not aware of how the Data Access Layer stores the data, so it's not aware of the data is stored in a relational database at all (if that's the case), and therefor should not have any code concerning SQL (such as protection against SQL injections).

If the Presentation Layer would contain code protecting the application against SQL injections attack, then if we changed from a relational database to a NoSQL database in the future, we would not only need to make changes to the code in the Data Access Layer (which should be the case), but also change the code in the Presentation Layer (removing the SQL protection code), which should not be the case.

</template>
<template v-slot:marking-guidelines>

* 1 point for correct answer and valid justification
* 0.5 points for wrong answer but valid justification for the correct answer (?! 😕)

</template>
</ExamQuestion>




### Question 11 (1p)
<ExamQuestion>
<template v-slot:question>

In a three layered architecture, one layer exposes a function called `selectAllFromTheAccountsTable()`. Is that a good or bad name on the function? Justify your answer.

</template>
<template v-slot:sample-answer>

That's a bad name, because it exposes implementation details. The name suggest we can use the function to fetch data from a relational database. This might be true now, but if we in the future change the Data Access Layer to store the data in another way (in a JS array, or in a JSON file, or in a NoSQL database, etc.), the name would simply no longer make any sense, and we would need to rename the function to something like `getAllAccounts()`, and we would need to change the code in the Business Logic Layer making use of this function. We should not need to change the code in the Business Logic Layer like that, so it should have the more general name `getAllAccounts()` from the beginning.

</template>
<template v-slot:marking-guidelines>

* 1 point for correct answer and valid justification
    * -0.25 points for having an almost valid justification, but missing some important detail

::: warning Note!
Some students claim the name of the function is good because it describes precisely what the function do. And yes, we want to have good descriptive names that reflects what data variables stores and what functions do, but usually (and crucially in interfaces), we don't want to expose implementation details. Since this function is used in another layer, its name should not expose implementation details.
:::

</template>
</ExamQuestion>




### Question 12 (2p)
<ExamQuestion>
<template v-slot:question>

Explain what a foreign key constraint is, and show an example of how things can go wrong if they aren't used properly.

</template>
<template v-slot:sample-answer>

A foreign key constraint is a constraint in a relational database that enforces a relation between a foreign key field in posts in one table to the primary key field in posts in another table. By enforcing the constraint, the database won't allow posts to be inserted in the first table unless it has a relation to an existing post in the other table. They are really important when we need to enforce such relations, which is the case for most applications using relational databases.

**Example** \
Imagine we have the two tables `Humans` and `Pets`. In our application, a pet must always belong to a human, because we don't want to have any homeless pets. So the field `humanId` in the `Pets` table has a foreign key constraint to the field `id` in the `Humans` table.

Thanks to this constraint, we can simply have a query like this to insert a new pet:

```sql
INSERT INTO Pets (humanId, name) VALUES (23, "Fishy")
```

If no human with the id `23` exists, the foreign key constraint would be violated, and the database would complain and not create the pet.

If we wouldn't have a foreign key constraint, we would first need to send a query like this one to see if we have a human with the given id:

```sql
SELECT * FROM Humans WHERE id = 23 LIMIT 1
```

And if we do get back a human, we can go ahead with creating the pet using the first query. However, before the database receives our "create pet" query, it might be that someone has deleted the human with id `23`, so we can't be 100% protected from having homeless pets this way, which is why foreign key constraints are better to use.

</template>
<template v-slot:marking-guidelines>

* 1 point for general explanation
    * -0.5 points for not knowing the difference between foreign key and foreign key constraint
* 1 point for example of problem when a foreign key is not used

::: warning Note!
Many students don't know the difference between a *foreign key* and a *foreign key constraint*. A foreign key is a field in one table, whose value will refer to a value in the primary key field in another table (all together known as a *relationship*). You can have this relationship without having a foreign key constraint. A foreign key constraint can be added to enforce and configure the relationship.
:::

</template>
</ExamQuestion>




## REST API




### Question 13 (1p)
<ExamQuestion>
<template v-slot:question>

Match each HTTP status code with its reason phrase.

Status codes: `200` `201` `400` `401` `404`

Reason Phrases: `Not Found` `OK` `Created` `Bad Request` `Unauthorized`

All needs to be matched correct to get any points.

</template>
<template v-slot:sample-answer>

* `200`: `OK`
* `201`: `Created`
* `400`: `Bad Request`
* `401`: `Unauthorized`
* `404`: `Not Found`

</template>
<template v-slot:marking-guidelines>

* 2 points for

</template>
</ExamQuestion>




### Question 14 (1p)
<ExamQuestion>
<template v-slot:question>

In an HTTP response with the status code 201, explain what the value of the `Location` header represents. Also, give an example of a value it can contain, and explain how that value should be interpreted.

</template>
<template v-slot:sample-answer>

The `Location` header's value represents the URI of the newly created resource (sending a GET request for it would give you back the newly created resource). The value could for example be `/movies/123`, meaning that a new movie resource was created, and that the new movie resource got `123` as a unique identifier among all movie resources.

</template>
<template v-slot:marking-guidelines>

* 0.5 points for general explanation of the value of the `Location` header (saying it redirects the user there is wrong, because the status code is 201)
* 0.25 points for example of value
* 0.25 points for explanation of that example value

</template>
</ExamQuestion>




### Question 15 (1p)
<ExamQuestion>
<template v-slot:question>

Does it makes sense to put a user's password in an ID Token? Justify your answer.

</template>
<template v-slot:sample-answer>

No. The whole idea with ID Tokens is that they contain information about the logged in user without exposing the user's credentials (such as password). And passwords should never be stored in plain text anyway, so putting it in an ID Token would simply be a security vulnerability. 

</template>
<template v-slot:marking-guidelines>

* 1 point for correct answer and valid justification
* -0.25 points for answers writing strange things
* 0 points for answers with multiple justifications, and at least one of them is wrong

</template>
</ExamQuestion>





### Question 16 (1p)
<ExamQuestion>
<template v-slot:question>

Does it makes sense to put a user's password in an Access Token? Justify your answer.

</template>
<template v-slot:sample-answer>

No. A password is *authentication information*, and that can be used to prove who the user is. Access Tokens should only contain *authorization information*, and that should describe what a holder of the token is allowed to do.

</template>
<template v-slot:marking-guidelines>

* 1 point for correct answer and valid justification
* -0.25 points for answers writing strange things
* 0 points for answers with multiple justifications, and at least one of them is wrong

::: warning Note!
Many students claim that it's bad to put sensitive information (such as passwords) in an Access Token since it's stored on the client and can end up in the hands of a hacker, which then would be able to read the user's password after decoding the token.

This is true WHEN the Access Token is self-contained, such as JWT tokens. Access Tokens don't have to be self-contained, so you really have to indicate in these type of answer that you are thinking of self-contained Access Tokens. I haven't punished that with point reduction this exam.
:::

</template>
</ExamQuestion>



## Security




### Question 17 (1p)
<ExamQuestion>
<template v-slot:question>

Give an example of a client-side HTTP request the web browser will not send due to the Same-Origin Policy.

</template>
<template v-slot:sample-answer>

An HTTP `DELETE` request sent to a domain other than the one the client-side code making the request (such as JavaScript) comes from.

</template>
<template v-slot:marking-guidelines>

* 1 point for a valid example

::: warning Note!
The Same-Origin Policy do allow some GET and POST requests to be sent (mainly those that can be sent through the submission of a `<form>`), but they won't allow client-side JavaScript to read the responses unless CORS headers have been added to the response, telling the web browser it's OK for the client-side JavaScript code to read it.
:::

</template>
</ExamQuestion>




### Question 18 (2p)
<ExamQuestion>
<template v-slot:question>

Web browsers started to support CORS around 2010. Today some companies still force their employees to run older versions of web browsers (from before 2010) that don't support CORS.

Given that all users don't have a web browser that supports CORS, can it be a security vulnerability to enable CORS on your web application? Justify your answer.

</template>
<template v-slot:sample-answer>

No, it can't, not based on that not all web browsers support CORS. CORS rather makes web browsers less secure by relaxing the Same-Origin Policy, and if a web browser doesn't support CORS, the Same-Origin Policy will simply not be relaxed, and remain as strict and secure as it already was.

</template>
<template v-slot:marking-guidelines>

* 2 points for correct answer and valid justification
* -0.5 points for saying something irrelevant

</template>
</ExamQuestion>




## Code Writing




### Question 19 (1p)
<ExamQuestion>
<template v-slot:question>

Implement the JavaScript function `isSumGreaterThan100(numbers)`, which receives an array with numbers, and returns:

* `true` if the sum of the numbers is greater than 100
* `false` otherwise

Sample usage:

* `isSumGreaterThan100([50, 25, 10]) → false`
* `isSumGreaterThan100([50, 100]) → true`

</template>
<template v-slot:sample-answer>

```js
function isSumGreaterThan100(numbers){
    
    let sum = 0
    
    for(const number of numbers){
        sum += number
    }
    
    return 100 < sum
    
}
```

</template>
<template v-slot:marking-guidelines>

* 1 point for a solution that largely works
* -0.1 points for each bad name
* -0.1 points for calling parameter `numbers`, but iteration variable `value` (use singular of parameter name!)
* -0.1 points for using `let` when could use `const`
* -0.1 points for using `var` when could use `let`
* -0.1 points for storing the function in global variable without `const`
* -0.1 for using `anArray.length()` instead of `anArray.length`
* -0.1 points for not having semicolon after all statements (if that's the convention you use)
* -0.1 points for having same code in `if` and `else` (factor it out)
* -0.1 points for each line not properly indented
* -0.1 points for naming `isSumGreaterThan100` wrong
* -0.2 points for each global variable created/assigned in the function
* -0.25 for implementing `!isSumGreaterThan100()`
* -0.25 for implementing `isSumGreaterThan_OR_EQUAL_TO_100()`
* -0.25 for iterating over indexes instead of values
* -0.25 for using variable that doesn't exist/hasn't been initialized
* -0.25 points for each syntax error

::: warning Note!

Some students think it's a good idea to put `100` in a constant named `oneHundred`. That is meaningless; reading `100` in the code gives the very same understanding as reading `oneHundred`, so stick to using `100` instead. When you have a better name on the value than just the amount it represents, then create a descriptive constant, like `const MAXIMUM_STUDENTS_IN_SCHOOL = 1500` instead of `const FIFTEEN_HUNDRED = 1500`.

The name of the function is *is**Sum**GreaterThan100*. As the name suggests, you obviously have to compute the ***sum*** of the numbers. What's a good name on the variable that stores the sum? `sum`! Many students instead call this variable something else, like `total`, `totalSum`, `summary`, `result`, etc., but this makes the code harder to read. Don't invent new names, stick to using existing names instead, and your code gets more consistent and easier to read.

:::

</template>
</ExamQuestion>




### Question 20 (1p)
<ExamQuestion>
<template v-slot:question>

Implement the client-side JavaScript function `makeCounter(button, startNumber)`, which receives an HTML Button object as the first argument, and makes that button function as a counter button (that is, `startNumber` should be used as the initial text in the button, and that text (number) should be incremented by 1 each time the button is clicked).

Sample usage:

```js
const aButton = document.getElementById('counter-button')
makeCounter(aButton, 10)
```

After the code above has been executed, the `<button>` with id `counter-button` should contain the text `10`, and clicking on it should change the text to `11`, and so one.

It should be possible to call the function multiple times with different buttons, and each counter button should function independently of the others.

</template>
<template v-slot:sample-answer>

```js
function makeCounter(button, startNumber){
    
    let number = startNumber
    button.innerText = number
    
    button.addEventListener('click', function(){
        number +=1
        button.innerText = number
    })
    
}
```

</template>
<template v-slot:marking-guidelines>

* 1 point for a solution that largely works
* -0.1 points for each bad name
* -0.1 points for each misspelled name
* -0.1 points for each parameter named wrong (names were given in the question)
* -0.1 points for using `var` when could use `let`
* -0.1 points for not naming `click` event correct
* -0.1 points for each line not properly indented
* -0.1 points for not naming `innerText`/`innerHTML` correct
* -0.1 points for storing the function in global variable without `const`
* -0.1 points for doing string concatenation with `1` on each click
* -0.2 points for each global variable created/assigned in the function
* -0.25 points for not showing the `startNumber` in the button immediately
* -0.25 points for not showing the incremented number in the button when the user clicks on the button

lkj



* -0.1 points for using `let` when could use `const`
* -0.1 for using `anArray.length()` instead of `anArray.length`
* -0.1 points for not having semicolon after all statements (if that's the convention you use)
* -0.1 points for having same code in `if` and `else` (factor it out)
* -0.1 points for naming `isSumGreaterThan100` wrong
* -0.25 for implementing `!isSumGreaterThan100()`
* -0.25 for implementing `isSumGreaterThan_OR_EQUAL_TO_100()`
* -0.25 for iterating over indexes instead of values
* -0.25 for using variable that doesn't exist/hasn't been initialized
* -0.25 points for each syntax error

::: warning Note!
Some students increment the parameter `startNumber` when the user clicks on the button. That's bad, because then the parameter is poorly named (it doesn't store the start value all the time, but should rather be name `currentValue`, or similar).
:::

</template>
</ExamQuestion>




### Question 21 (4p)
<ExamQuestion>
<template v-slot:question>

The function `getMovieByTitle()` can be used to fetch a movie with a specific title asynchronously from the server like this:

```js
getMovieByTitle("Shrek", function(error, movie){
    if(error){
        // Couldn't fetch the movie.
    }else{
        // Do something with the movie.
        // movie = {id: 3, title: "Shrek"}
    }
})
```

The function `getReviewsByMovieId()` can be used to fetch all reviews a movie with a specific id has asynchronously from the server like this:

```js
getReviewsByMovieId(5, function(error, reviews){
    if(error){
        // Couldn't fetch the reviews.
    }else{
        // Do something with the reviews.
        // reviews = [
        //   {id: 2, movieId: 5, rating: 8},
        //   {id: 5, movieId: 5, rating: 3},
        //   {id: 9, movieId: 5, rating: 9},
        //   ...
        // ]
    }
})
```

Implement the function `getBestMovie(title1, title2, callback)`, which receives the title of two movies as arguments, and should send back the movie object with the highest average rating through the callback function. 

Sample usage:

```js
getBestMovie("Shrek", "Die another day", function(error, bestMovie){
    if(error){
        console.log("Problem fetching required info.", error)
    }else{
        console.log("The best movie is "+bestMovie.title+".")
    }
})
```

Important details:

* The callback function should be called only once
* As soon as any function gives an error, the callback function should be called with that error (the other argument should be `null`)
* The data should be fetched as fast as possible (loading times should be minimized)
* When suitable, create helper functions (avoid repeating code)

</template>
<template v-slot:sample-answer>

```js
function getBestMovie(title1, title2, callback){
    
    // This is the structure of the data we need to compute.
    const movieAndAverageRatings = [
        // {movie: theMovieObject, averageRating: 0}
        // {movie: theMovieObject, averageRating: 0}
    ]
    
    let hasSentBackError = false
    
    // Fetch the two movies in parallel.
    getMovieByTitle(title1, onMovieFetched)
    getMovieByTitle(title2, onMovieFetched)
    
    function onMovieFetched(error, movie){
        
        if(hasSentBackError){
            
            // Something has already gone wrong, we don't need to continue.
            
        }else if(error){
            
            callback(error, null)
            hasSentBackError = true
            
        }else{
            
            // Fetch the reviews for the movie.
            getReviewsByMovieId(movie.id, function(error, reviews){
                onReviewsFetched(error, reviews, movie)
            })
            
        }
        
    }
    
    function onReviewsFetched(error, reviews, movie){
        
        if(hasSentBackError){
            
            // Something has already gone wrong, we don't need to continue.
            
        }else if(error){
            
            callback(error, null)
            hasSentBackError = true
            
        }else{
            
            // Compute average and remember it.
            movieAndAverageRatings.push({
                movie,
                averageRating: getAverageRating(reviews)
            })
            
            // Check if we have computed average rating for both movies.
            if(movieAndAverageRatings.length == 2){
                
                // Check which movie has best rating.
                if(movieAndAverageRatings[0].averageRating < movieAndAverageRatings[1].averageRating){
                    callback(null, movieAndAverageRatings[1].movie)
                }else{
                    callback(null, movieAndAverageRatings[0].movie)
                }
                
            }
            
        }
        
    }
    
    function getAverageRating(reviews){
        
        let ratingsSum = 0
        
        for(const review of reviews){
            ratingSum += review.rating
        }
        
        return ratingSum / reviews.length
        
    }
    
}
```

</template>
<template v-slot:marking-guidelines>

* 4 points for a solution that largely works
    * -1 point for not sending back movie object (but title, or average rating, or something else)
    * -1 point for possibly calling callback multiple times
    * -1 point for not sending requests in parallel
    * -1 point for kind of having the same code for both movies, instead of a generalized function
    * -0.2 points for each other error (indentation error, poor name, wrong name, const/var/let wrong, etc.)
* 0 points for a solution that assumes callback function runs synchronously (called immediately), such as:
```js
let fetchedMovie = null
getMovieByTitle("Shrek", function(error, movie){
    fetchedMovie = movie
})
console.log(fetchedMovie.id) // This won't work, this line is executed before the asynchronous callback function is called, so fetchedMovie is null.
```

::: warning Note!
There are some cases I've ignored to handle, such as:

* If a movie has no reviews, computing it's average will be wrong (`0/0` in my solution)
* If the two movies have the same average rating, it's unclear which to send back

Extra star in the corner to the students that thought of these cases!
:::

</template>
</ExamQuestion>